{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/ts/gl-utils/gl-canvas.ts","webpack:///./src/ts/gl-utils/gl-resource.ts","webpack:///./src/ts/format-utils.ts","webpack:///./src/ts/parameters.ts","webpack:///./src/ts/gl-utils/shader-manager.ts","webpack:///./src/ts/gl-utils/vbo.ts","webpack:///./src/ts/gl-utils/matrix/vec3.ts","webpack:///./src/ts/main.ts","webpack:///./src/ts/converter.ts","webpack:///./src/ts/gl-utils/shader.ts","webpack:///./src/ts/gl-utils/shader-sources.ts","webpack:///./src/ts/gl-utils/viewport.ts","webpack:///./src/ts/viewer.ts","webpack:///./src/ts/gl-utils/matrix/mat4.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","gl","initGL","flags","setError","message","Demopage","setErrorMessage","canvas","Canvas","getCanvas","getContext","disable","CULL_FACE","DEPTH_TEST","BLEND","clearColor","adjustSize","hidpi","cssPixel","window","devicePixelRatio","width","Math","floor","clientWidth","height","clientHeight","GLResource","this","_gl","default","Format","FormatUtils","guessFormat","image","mayBeSkybox","Skybox","ratio","abs","Tinyplanet","Skysphere","parseString","str","format","context","document","createElement","drawImage","testedPixels","x","y","reference","getImageData","data","_i","testedPixels_1","length","tested","sample","format_utils_1","onChangeObservers","Array","callOnChangeObservers","_a","Parameters","callback","onImageLoadObservers","FileControl","addUploadObserver","files","showLoader","reader","FileReader","onload","Image","src","result","readAsDataURL","inputFormat","outputFormat","onInputFormatChangeObservers","Tabs","addObserver","values","previous","onInputFormatChangeObservers_1","outputPreview","fov","Checkbox","checked","showFrame","Range","newFov","PI","paddingTOP","paddingBottom","margin","paddingBack","rotateZ","flipVertically","Observers","mouseWheel","push","delta","configurable","set","img","addEventListener","removeErrorMessage","onImageLoadObservers_1","console","error","setValues","show","setChecked","getValues","setValue","getValue","css","type","innerHTML","body","appendChild","__importDefault","mod","__importStar","k","gl_canvas_1","shader_1","ShaderSources","cachedShaders","buildShader","infos","sourcesPending","sourcesFailed","loadedSource","success","shader","vert","getSource","vertexFilename","frag","fragmentFilename","loadSource","getShader","registerShader","callAndClearCallbacks","cached","callbacks","cachedCallback","failed","pending","cached_1","builtShader","deleteShader","freeGLResources","extendStatics","__extends","b","setPrototypeOf","__proto__","__","constructor","VBO","_super","array","size","_this","id","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","normalize","stride","offset","createQuad","minX","minY","maxX","maxY","Float32Array","FLOAT","deleteBuffer","location","enableVertexAttribArray","vertexAttribPointer","Vec3","z","_val","dotProduct","v1","v2","crossProduct","substract","equals","other","divideByScalar","scalar","norm","sqrt","converter_1","GlCanvas","viewport_1","parameters_1","viewer_1","resetEditControls","paddingTop","previewOutput","alpha","preserveDrawingBuffer","viewer","converter","forceRedraw","addDownloadObserver","idealWidth","outputPercentage","pow","log","LOG2E","restoreCanvas","style","position","setFullCanvas","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","draw","texture","msToBlob","blob","navigator","msSaveBlob","toBlob","link","download","href","URL","createObjectURL","click","previewViewport","requestAnimationFrame","mainLoop","update","needToRedraw","drawingBufferWidth","main","gl_resource_1","ShaderManager","vbo_1","Converter","_vbo","u","use","bindUniformsAndAttributes","drawArrays","TRIANGLE_STRIP","vertex","fragment","a","_shaderBoxToBox","_shaderBoxToSphere","_shaderBoxToPlanet","_shaderSphereToBox","_shaderSphereToSphere","_shaderSphereToPlanet","_shaderPlanetToBox","_shaderPlanetToSphere","_shaderPlanetToPlanet","notImplemented","alert","types","35664","binder","uniform2fv","35665","uniform3fv","35666","uniform4fv","35667","uniform2iv","35668","uniform3iv","35669","uniform4iv","35670","uniform1i","35671","35672","35673","35674","uniformMatrix2fv","35675","uniformMatrix3fv","35676","uniformMatrix4fv","35678","unitNb","activeTexture","bindTexture","TEXTURE_2D","35680","TEXTURE_CUBE_MAP","5120","5121","5122","5123","5124","isArray","uniform1iv","5125","5126","uniform1fv","uniform1f","ShaderProgram","vertexSource","fragmentSource","createShader","source","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","uCount","aCount","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","introspection","getProgramInfoLog","deleteProgram","useProgram","bindUniforms","currTextureUnitNb","keys","forEach","uName","uniform","loc","bindAttributes","aName","attribute","ACTIVE_UNIFORMS","getActiveUniform","name_1","getUniformLocation","ACTIVE_ATTRIBUTES","getActiveAttrib","name_2","getAttribLocation","cachedSources","filename","text","xhr_1","XMLHttpRequest","open","readyState","status","responseText","statusText","onerror","send","Viewport","left","lower","viewport","drawingBufferHeight","mat4_1","vec3_1","Viewer","_eyePos","_vertical","_tmpMatrix","Mat4","_projToWorldMatrix","resetThetaPhi","_needToReloadImage","_needToRedraw","doNeedToRedraw","doNeedToReloadImage","newOne","canvasResize","mouseDrag","dX","dY","_phi","getAspectRatio","_theta","min","max","_texture","deleteTexture","_shaderSkybox","_shaderSkysphere","_shaderTinyplanet","splitAndLoadSkybox","loadTexture","recomputeMatrices","val","createTexture","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","side","ceil","sidesStyles","target","TEXTURE_CUBE_MAP_POSITIVE_X","rotation","TEXTURE_CUBE_MAP_NEGATIVE_X","TEXTURE_CUBE_MAP_POSITIVE_Y","TEXTURE_CUBE_MAP_NEGATIVE_Y","TEXTURE_CUBE_MAP_POSITIVE_Z","TEXTURE_CUBE_MAP_NEGATIVE_Z","translate","scale","sourceWidth","sourceHeight","sidesStyles_1","sideStyle","rotate","generateMipmap","LINEAR_MIPMAP_LINEAR","lookAt","sin","cos","invert","aspectRatio","perspectiveInverse","Infinity","multiplyRight","identity","eye","center","up","m2","tmp","tmpMatrix","myself","iCol","iRow","swapWithTmpMatrix","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","tmpVals","perspective","fovy","nearPlane","farPlane","f","tan"],"mappings":"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","file":"main.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl = null;\r\nexports.gl = gl;\r\nfunction initGL(flags) {\r\n    function setError(message) {\r\n        Demopage.setErrorMessage(\"webgl-support\", message);\r\n    }\r\n    var canvas = Canvas.getCanvas();\r\n    exports.gl = gl = canvas.getContext(\"webgl\", flags);\r\n    if (gl == null) {\r\n        exports.gl = gl = canvas.getContext(\"experimental-webgl\", flags);\r\n        if (gl == null) {\r\n            setError(\"Your browser or device does not seem to support WebGL.\");\r\n            return false;\r\n        }\r\n        setError(\"Your browser or device only supports experimental WebGL.\\n\" +\r\n            \"The simulation may not run as expected.\");\r\n    }\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.disable(gl.DEPTH_TEST);\r\n    gl.disable(gl.BLEND);\r\n    gl.clearColor(0.0, 0.0, 0.0, 1.0);\r\n    return true;\r\n}\r\nexports.initGL = initGL;\r\nfunction adjustSize(hidpi) {\r\n    if (hidpi === void 0) { hidpi = false; }\r\n    var cssPixel = (hidpi) ? window.devicePixelRatio : 1;\r\n    var width = Math.floor(gl.canvas.clientWidth * cssPixel);\r\n    var height = Math.floor(gl.canvas.clientHeight * cssPixel);\r\n    if (gl.canvas.width !== width || gl.canvas.height !== height) {\r\n        gl.canvas.width = width;\r\n        gl.canvas.height = height;\r\n    }\r\n}\r\nexports.adjustSize = adjustSize;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar GLResource = (function () {\r\n    function GLResource(gl) {\r\n        this._gl = gl;\r\n    }\r\n    GLResource.prototype.gl = function () {\r\n        return this._gl;\r\n    };\r\n    return GLResource;\r\n}());\r\nexports.default = GLResource;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Format;\r\n(function (Format) {\r\n    Format[\"Skybox\"] = \"skybox\";\r\n    Format[\"Skysphere\"] = \"skysphere\";\r\n    Format[\"Tinyplanet\"] = \"tinyplanet\";\r\n})(Format || (Format = {}));\r\nexports.Format = Format;\r\nvar FormatUtils = (function () {\r\n    function FormatUtils() {\r\n    }\r\n    FormatUtils.guessFormat = function (image) {\r\n        if (FormatUtils.mayBeSkybox(image)) {\r\n            return Format.Skybox;\r\n        }\r\n        var ratio = image.width / image.height;\r\n        if (Math.abs(ratio - 1) < 0.1) {\r\n            return Format.Tinyplanet;\r\n        }\r\n        return Format.Skysphere;\r\n    };\r\n    FormatUtils.parseString = function (str) {\r\n        if (str === Format.Skybox) {\r\n            return Format.Skybox;\r\n        }\r\n        else if (str === Format.Tinyplanet) {\r\n            return Format.Tinyplanet;\r\n        }\r\n        else {\r\n            return Format.Skysphere;\r\n        }\r\n    };\r\n    FormatUtils.ratio = function (format) {\r\n        if (format === Format.Skybox) {\r\n            return 4 / 3;\r\n        }\r\n        else if (format === Format.Skysphere) {\r\n            return 2;\r\n        }\r\n        else {\r\n            return 1;\r\n        }\r\n    };\r\n    FormatUtils.mayBeSkybox = function (image) {\r\n        var context = document.createElement(\"canvas\").getContext(\"2d\");\r\n        context.canvas.width = 8;\r\n        context.canvas.height = 6;\r\n        context.drawImage(image, 0, 0, context.canvas.width, context.canvas.height);\r\n        var testedPixels = [\r\n            { x: 0, y: 0 }, { x: 5, y: 0 }, { x: 6, y: 0 }, { x: 7, y: 0 },\r\n            { x: 0, y: 5 }, { x: 5, y: 5 }, { x: 6, y: 5 }, { x: 7, y: 5 },\r\n        ];\r\n        var reference = context.getImageData(testedPixels[0].x, testedPixels[0].y, 1, 1).data;\r\n        for (var _i = 0, testedPixels_1 = testedPixels; _i < testedPixels_1.length; _i++) {\r\n            var tested = testedPixels_1[_i];\r\n            var sample = context.getImageData(tested.x, tested.y, 1, 1).data;\r\n            for (var i = 0; i < 4; ++i) {\r\n                if (sample[i] !== reference[i]) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    return FormatUtils;\r\n}());\r\nexports.FormatUtils = FormatUtils;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar format_utils_1 = require(\"./format-utils\");\r\nvar onChangeObservers = new Array();\r\nfunction callOnChangeObservers() {\r\n    for (var _i = 0, _a = Parameters.onChangeObservers; _i < _a.length; _i++) {\r\n        var callback = _a[_i];\r\n        callback();\r\n    }\r\n}\r\nvar onImageLoadObservers = new Array();\r\nvar image;\r\nvar FILE_UPLOAD_CONTROL = \"file-upload-id\";\r\nFileControl.addUploadObserver(FILE_UPLOAD_CONTROL, function (files) {\r\n    Canvas.showLoader(true);\r\n    var reader = new FileReader();\r\n    reader.onload = function () {\r\n        Parameters.image = new Image();\r\n        Parameters.image.src = reader.result;\r\n    };\r\n    reader.readAsDataURL(files[0]);\r\n});\r\nvar onInputFormatChangeObservers = new Array();\r\nvar inputFormat;\r\nvar INPUT_FORMAT_CONTROL = \"input-format\";\r\nTabs.addObserver(INPUT_FORMAT_CONTROL, function (values) {\r\n    var previous = inputFormat;\r\n    inputFormat = format_utils_1.FormatUtils.parseString(values[0]);\r\n    for (var _i = 0, onInputFormatChangeObservers_1 = onInputFormatChangeObservers; _i < onInputFormatChangeObservers_1.length; _i++) {\r\n        var callback = onInputFormatChangeObservers_1[_i];\r\n        callback(previous, inputFormat);\r\n    }\r\n});\r\nvar outputFormat;\r\nvar OUTPUT_FORMAT_CONTROL = \"output-format\";\r\nTabs.addObserver(OUTPUT_FORMAT_CONTROL, function (values) {\r\n    outputFormat = format_utils_1.FormatUtils.parseString(values[0]);\r\n    callOnChangeObservers();\r\n});\r\nvar outputPreview;\r\nvar OUPUT_PREVIEW_CONTROL = \"output-preview-id\";\r\nCheckbox.addObserver(OUPUT_PREVIEW_CONTROL, function (checked) {\r\n    outputPreview = checked;\r\n    callOnChangeObservers();\r\n});\r\nvar fov;\r\nvar FOV_CONTROL = \"fov-range-id\";\r\nRange.addObserver(FOV_CONTROL, function (newFov) {\r\n    fov = Math.PI / 180 * newFov;\r\n    callOnChangeObservers();\r\n});\r\nvar showFrame;\r\nvar FRAME_CONTROL = \"frame-checkbox-id\";\r\nCheckbox.addObserver(FRAME_CONTROL, function (checked) {\r\n    showFrame = checked;\r\n    callOnChangeObservers();\r\n});\r\nvar paddingTOP;\r\nvar PADDING_TOP_CONTROL = \"padding-top-range-id\";\r\nRange.addObserver(PADDING_TOP_CONTROL, function (margin) {\r\n    paddingTOP = margin;\r\n    callOnChangeObservers();\r\n});\r\nvar paddingBottom;\r\nvar PADDING_BOTTOM_CONTROL = \"padding-bottom-range-id\";\r\nRange.addObserver(PADDING_BOTTOM_CONTROL, function (margin) {\r\n    paddingBottom = margin;\r\n    callOnChangeObservers();\r\n});\r\nvar paddingBack;\r\nvar PADDING_BACK_CONTROL = \"padding-back-range-id\";\r\nRange.addObserver(PADDING_BACK_CONTROL, function (margin) {\r\n    paddingBack = margin;\r\n    callOnChangeObservers();\r\n});\r\nvar rotateZ;\r\nvar ROTATE_Z_CONTROL = \"rotate-z-range-id\";\r\nRange.addObserver(ROTATE_Z_CONTROL, function (r) {\r\n    rotateZ = r;\r\n    callOnChangeObservers();\r\n});\r\nvar flipVertically;\r\nvar FLIP_VERTICALLY_CONTROL = \"flip-vertically-checkbox-id\";\r\nCheckbox.addObserver(FLIP_VERTICALLY_CONTROL, function (checked) {\r\n    flipVertically = checked;\r\n    callOnChangeObservers();\r\n});\r\nCanvas.Observers.mouseWheel.push(function (delta) {\r\n    Parameters.fov += delta * 10 * Math.PI / 180;\r\n});\r\nvar Parameters = (function () {\r\n    function Parameters() {\r\n    }\r\n    Object.defineProperty(Parameters, \"onChangeObservers\", {\r\n        get: function () {\r\n            return onChangeObservers;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"onInputFormatChangeObservers\", {\r\n        get: function () {\r\n            return onInputFormatChangeObservers;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"onImageLoadObservers\", {\r\n        get: function () {\r\n            return onImageLoadObservers;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"image\", {\r\n        get: function () {\r\n            return image;\r\n        },\r\n        set: function (img) {\r\n            var ERROR_MESSAGE_ID = \"invalid-image\";\r\n            image = img;\r\n            image.addEventListener(\"load\", function () {\r\n                Demopage.removeErrorMessage(ERROR_MESSAGE_ID);\r\n                for (var _i = 0, onImageLoadObservers_1 = onImageLoadObservers; _i < onImageLoadObservers_1.length; _i++) {\r\n                    var callback = onImageLoadObservers_1[_i];\r\n                    callback(image);\r\n                }\r\n                callOnChangeObservers();\r\n            });\r\n            image.addEventListener(\"error\", function () {\r\n                Demopage.setErrorMessage(ERROR_MESSAGE_ID, \"The image could not be loaded.\");\r\n                Canvas.showLoader(false);\r\n                console.error(\"Image could not be loaded.\");\r\n            });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"inputFormat\", {\r\n        get: function () {\r\n            return inputFormat;\r\n        },\r\n        set: function (value) {\r\n            inputFormat = value;\r\n            Tabs.setValues(INPUT_FORMAT_CONTROL, [value]);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"previewOutput\", {\r\n        get: function () {\r\n            return outputPreview;\r\n        },\r\n        set: function (show) {\r\n            outputPreview = show;\r\n            Checkbox.setChecked(OUPUT_PREVIEW_CONTROL, show);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"outputFormat\", {\r\n        get: function () {\r\n            return outputFormat;\r\n        },\r\n        set: function (value) {\r\n            outputFormat = value;\r\n            Tabs.setValues(OUTPUT_FORMAT_CONTROL, [value]);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"outputPercentage\", {\r\n        get: function () {\r\n            return +Tabs.getValues(\"output-quality\")[0] / 100;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"fov\", {\r\n        get: function () {\r\n            return fov;\r\n        },\r\n        set: function (value) {\r\n            Range.setValue(FOV_CONTROL, value * 180 / Math.PI);\r\n            fov = Range.getValue(FOV_CONTROL) * Math.PI / 180;\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"showFrame\", {\r\n        get: function () {\r\n            return showFrame;\r\n        },\r\n        set: function (show) {\r\n            showFrame = show;\r\n            Checkbox.setChecked(FRAME_CONTROL, show);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"paddingTop\", {\r\n        get: function () {\r\n            return paddingTOP;\r\n        },\r\n        set: function (margin) {\r\n            Range.setValue(PADDING_TOP_CONTROL, margin);\r\n            paddingTOP = Range.getValue(PADDING_TOP_CONTROL);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"paddingBottom\", {\r\n        get: function () {\r\n            return paddingBottom;\r\n        },\r\n        set: function (margin) {\r\n            Range.setValue(PADDING_BOTTOM_CONTROL, margin);\r\n            paddingBottom = Range.getValue(PADDING_BOTTOM_CONTROL);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"paddingBack\", {\r\n        get: function () {\r\n            return paddingBack;\r\n        },\r\n        set: function (margin) {\r\n            Range.setValue(PADDING_BACK_CONTROL, margin);\r\n            paddingBack = Range.getValue(PADDING_BACK_CONTROL);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"rotateZ\", {\r\n        get: function () {\r\n            return rotateZ;\r\n        },\r\n        set: function (r) {\r\n            Range.setValue(ROTATE_Z_CONTROL, r);\r\n            rotateZ = Range.getValue(ROTATE_Z_CONTROL);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"flipVertically\", {\r\n        get: function () {\r\n            return flipVertically;\r\n        },\r\n        set: function (show) {\r\n            flipVertically = show;\r\n            Checkbox.setChecked(FLIP_VERTICALLY_CONTROL, show);\r\n            callOnChangeObservers();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Parameters;\r\n}());\r\nexports.Parameters = Parameters;\r\nvar css = document.createElement(\"style\");\r\ncss.type = \"text/css\";\r\ncss.innerHTML = \"canvas:active { cursor: grab; }\";\r\ndocument.body.appendChild(css);\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result[\"default\"] = mod;\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_canvas_1 = require(\"./gl-canvas\");\r\nvar shader_1 = __importDefault(require(\"./shader\"));\r\nvar ShaderSources = __importStar(require(\"./shader-sources\"));\r\nvar cachedShaders = {};\r\nfunction getShader(name) {\r\n    return cachedShaders[name].shader;\r\n}\r\nexports.getShader = getShader;\r\nfunction buildShader(infos, callback) {\r\n    var sourcesPending = 2;\r\n    var sourcesFailed = 0;\r\n    function loadedSource(success) {\r\n        sourcesPending--;\r\n        if (!success) {\r\n            sourcesFailed++;\r\n        }\r\n        if (sourcesPending === 0) {\r\n            var shader = null;\r\n            if (sourcesFailed === 0) {\r\n                var vert = ShaderSources.getSource(infos.vertexFilename);\r\n                var frag = ShaderSources.getSource(infos.fragmentFilename);\r\n                shader = new shader_1.default(gl_canvas_1.gl, vert, frag);\r\n            }\r\n            callback(shader);\r\n        }\r\n    }\r\n    ShaderSources.loadSource(infos.vertexFilename, loadedSource);\r\n    ShaderSources.loadSource(infos.fragmentFilename, loadedSource);\r\n}\r\nexports.buildShader = buildShader;\r\nfunction registerShader(name, infos, callback) {\r\n    function callAndClearCallbacks(cached) {\r\n        for (var _i = 0, _a = cached.callbacks; _i < _a.length; _i++) {\r\n            var cachedCallback = _a[_i];\r\n            cachedCallback(!cached.failed, cached.shader);\r\n        }\r\n        cached.callbacks = [];\r\n    }\r\n    if (typeof cachedShaders[name] === \"undefined\") {\r\n        cachedShaders[name] = {\r\n            callbacks: [callback],\r\n            failed: false,\r\n            infos: infos,\r\n            pending: true,\r\n            shader: null,\r\n        };\r\n        var cached_1 = cachedShaders[name];\r\n        buildShader(infos, function (builtShader) {\r\n            cached_1.pending = false;\r\n            cached_1.failed = builtShader === null;\r\n            cached_1.shader = builtShader;\r\n            callAndClearCallbacks(cached_1);\r\n        });\r\n    }\r\n    else {\r\n        var cached = cachedShaders[name];\r\n        if (cached.pending === true) {\r\n            cached.callbacks.push(callback);\r\n        }\r\n        else {\r\n            callAndClearCallbacks(cached);\r\n        }\r\n    }\r\n}\r\nexports.registerShader = registerShader;\r\nfunction deleteShader(name) {\r\n    if (cachedShaders[name]) {\r\n        if (cachedShaders[name].shader) {\r\n            cachedShaders[name].shader.freeGLResources();\r\n        }\r\n        delete cachedShaders[name];\r\n    }\r\n}\r\nexports.deleteShader = deleteShader;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\r\nvar VBO = (function (_super) {\r\n    __extends(VBO, _super);\r\n    function VBO(gl, array, size, type) {\r\n        var _this = _super.call(this, gl) || this;\r\n        _this.id = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, _this.id);\r\n        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        _this.size = size;\r\n        _this.type = type;\r\n        _this.normalize = false;\r\n        _this.stride = 0;\r\n        _this.offset = 0;\r\n        return _this;\r\n    }\r\n    VBO.createQuad = function (gl, minX, minY, maxX, maxY) {\r\n        var vert = [\r\n            minX, minY,\r\n            maxX, minY,\r\n            minX, maxY,\r\n            maxX, maxY,\r\n        ];\r\n        return new VBO(gl, new Float32Array(vert), 2, gl.FLOAT);\r\n    };\r\n    VBO.prototype.freeGLResources = function () {\r\n        this.gl().deleteBuffer(this.id);\r\n        this.id = null;\r\n    };\r\n    VBO.prototype.bind = function (location) {\r\n        var gl = _super.prototype.gl.call(this);\r\n        gl.enableVertexAttribArray(location);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.id);\r\n        gl.vertexAttribPointer(location, this.size, this.type, this.normalize, this.stride, this.offset);\r\n    };\r\n    return VBO;\r\n}(gl_resource_1.default));\r\nexports.default = VBO;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar EPSILON = 0.0001;\r\nvar Vec3 = (function () {\r\n    function Vec3(x, y, z) {\r\n        this._val = new Float32Array(3);\r\n        this._val[0] = x;\r\n        this._val[1] = y;\r\n        this._val[2] = z;\r\n    }\r\n    Vec3.dotProduct = function (v1, v2) {\r\n        return v1._val[0] * v2._val[0] +\r\n            v1._val[1] * v2._val[1] +\r\n            v1._val[2] * v2._val[2];\r\n    };\r\n    Vec3.crossProduct = function (v1, v2) {\r\n        return new Vec3(v1._val[1] * v2._val[2] - v1._val[2] * v2._val[1], v1._val[2] * v2._val[0] - v1._val[0] * v2._val[2], v1._val[0] * v2._val[1] - v1._val[1] * v2._val[0]);\r\n    };\r\n    Vec3.substract = function (v1, v2) {\r\n        return new Vec3(v1._val[0] - v2._val[0], v1._val[1] - v2._val[1], v1._val[2] - v2._val[2]);\r\n    };\r\n    Object.defineProperty(Vec3.prototype, \"x\", {\r\n        get: function () {\r\n            return this._val[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Vec3.prototype, \"y\", {\r\n        get: function () {\r\n            return this._val[1];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Vec3.prototype, \"z\", {\r\n        get: function () {\r\n            return this._val[2];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Vec3.prototype.equals = function (other) {\r\n        return Math.abs(this._val[0] - other._val[0]) < EPSILON &&\r\n            Math.abs(this._val[1] - other._val[1]) < EPSILON &&\r\n            Math.abs(this._val[2] - other._val[2]) < EPSILON;\r\n    };\r\n    Vec3.prototype.divideByScalar = function (scalar) {\r\n        this._val[0] /= scalar;\r\n        this._val[1] /= scalar;\r\n        this._val[2] /= scalar;\r\n    };\r\n    Vec3.prototype.substract = function (other) {\r\n        this._val[0] -= other._val[0];\r\n        this._val[1] -= other._val[1];\r\n        this._val[2] -= other._val[2];\r\n    };\r\n    Object.defineProperty(Vec3.prototype, \"length\", {\r\n        get: function () {\r\n            var norm = this._val[0] * this._val[0] +\r\n                this._val[1] * this._val[1] +\r\n                this._val[2] * this._val[2];\r\n            return Math.sqrt(norm);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Vec3.prototype.normalize = function () {\r\n        if (Math.abs(this._val[0]) < EPSILON &&\r\n            Math.abs(this._val[1]) < EPSILON &&\r\n            Math.abs(this._val[2]) < EPSILON) {\r\n            this._val[0] = 0;\r\n            this._val[1] = 0;\r\n            this._val[2] = 0;\r\n            return false;\r\n        }\r\n        this.divideByScalar(this.length);\r\n        return true;\r\n    };\r\n    return Vec3;\r\n}());\r\nexports.Vec3 = Vec3;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result[\"default\"] = mod;\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar converter_1 = __importDefault(require(\"./converter\"));\r\nvar format_utils_1 = require(\"./format-utils\");\r\nvar GlCanvas = __importStar(require(\"./gl-utils/gl-canvas\"));\r\nvar gl_canvas_1 = require(\"./gl-utils/gl-canvas\");\r\nvar viewport_1 = __importDefault(require(\"./gl-utils/viewport\"));\r\nvar parameters_1 = require(\"./parameters\");\r\nvar viewer_1 = __importDefault(require(\"./viewer\"));\r\nfunction main() {\r\n    function resetEditControls() {\r\n        parameters_1.Parameters.paddingTop = 0;\r\n        parameters_1.Parameters.paddingBottom = 0;\r\n        parameters_1.Parameters.paddingBack = 0;\r\n        parameters_1.Parameters.rotateZ = 0;\r\n        parameters_1.Parameters.flipVertically = false;\r\n    }\r\n    Canvas.showLoader(true);\r\n    parameters_1.Parameters.onImageLoadObservers.push(resetEditControls);\r\n    parameters_1.Parameters.image = new Image();\r\n    parameters_1.Parameters.image.src = \"./images/skybox.jpg\";\r\n    parameters_1.Parameters.inputFormat = format_utils_1.Format.Skybox;\r\n    parameters_1.Parameters.outputFormat = format_utils_1.Format.Skysphere;\r\n    parameters_1.Parameters.previewOutput = false;\r\n    parameters_1.Parameters.fov = 70 * Math.PI / 180;\r\n    parameters_1.Parameters.showFrame = false;\r\n    resetEditControls();\r\n    var glParams = {\r\n        alpha: false,\r\n        preserveDrawingBuffer: true,\r\n    };\r\n    if (!GlCanvas.initGL(glParams)) {\r\n        return;\r\n    }\r\n    var viewer = new viewer_1.default();\r\n    var converter = new converter_1.default();\r\n    var forceRedraw = false;\r\n    FileControl.addDownloadObserver(\"file-download-id\", function () {\r\n        var idealWidth = parameters_1.Parameters.image.width * parameters_1.Parameters.outputPercentage;\r\n        var width = Math.pow(2, Math.floor(Math.log(idealWidth) * Math.LOG2E));\r\n        var height = width / format_utils_1.FormatUtils.ratio(parameters_1.Parameters.outputFormat);\r\n        var canvas = Canvas.getCanvas();\r\n        canvas.style.position = \"absolute\";\r\n        canvas.style.width = width + \"px\";\r\n        canvas.style.height = height + \"px\";\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        GlCanvas.adjustSize();\r\n        viewport_1.default.setFullCanvas(gl_canvas_1.gl);\r\n        gl_canvas_1.gl.clear(gl_canvas_1.gl.COLOR_BUFFER_BIT | gl_canvas_1.gl.DEPTH_BUFFER_BIT);\r\n        converter.draw(viewer.texture);\r\n        gl_canvas_1.gl.clear(gl_canvas_1.gl.COLOR_BUFFER_BIT | gl_canvas_1.gl.DEPTH_BUFFER_BIT);\r\n        converter.draw(viewer.texture);\r\n        function restoreCanvas() {\r\n            canvas.style.position = \"\";\r\n            canvas.style.width = \"\";\r\n            canvas.style.height = \"\";\r\n            forceRedraw = true;\r\n        }\r\n        if (canvas.msToBlob) {\r\n            var blob = canvas.msToBlob();\r\n            window.navigator.msSaveBlob(blob, \"image.png\");\r\n            restoreCanvas();\r\n        }\r\n        else {\r\n            canvas.toBlob(function (blob) {\r\n                var link = document.createElement(\"a\");\r\n                link.download = \"image.png\";\r\n                link.href = URL.createObjectURL(blob);\r\n                link.click();\r\n                restoreCanvas();\r\n            });\r\n        }\r\n    });\r\n    var previewViewport = new viewport_1.default(0, 0, 1, 1);\r\n    function mainLoop() {\r\n        viewer.update();\r\n        if (viewer.needToRedraw || forceRedraw) {\r\n            GlCanvas.adjustSize();\r\n            viewport_1.default.setFullCanvas(gl_canvas_1.gl);\r\n            gl_canvas_1.gl.clear(gl_canvas_1.gl.COLOR_BUFFER_BIT | gl_canvas_1.gl.DEPTH_BUFFER_BIT);\r\n            viewer.draw();\r\n            if (parameters_1.Parameters.previewOutput) {\r\n                previewViewport.width = 0.3 * gl_canvas_1.gl.drawingBufferWidth;\r\n                previewViewport.height = previewViewport.width / format_utils_1.FormatUtils.ratio(parameters_1.Parameters.outputFormat);\r\n                previewViewport.set(gl_canvas_1.gl);\r\n                converter.draw(viewer.texture);\r\n            }\r\n            forceRedraw = false;\r\n        }\r\n        requestAnimationFrame(mainLoop);\r\n    }\r\n    requestAnimationFrame(mainLoop);\r\n}\r\nmain();\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result[\"default\"] = mod;\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_canvas_1 = require(\"./gl-utils/gl-canvas\");\r\nvar gl_resource_1 = __importDefault(require(\"./gl-utils/gl-resource\"));\r\nvar ShaderManager = __importStar(require(\"./gl-utils/shader-manager\"));\r\nvar vbo_1 = __importDefault(require(\"./gl-utils/vbo\"));\r\nvar format_utils_1 = require(\"./format-utils\");\r\nvar parameters_1 = require(\"./parameters\");\r\nvar Converter = (function (_super) {\r\n    __extends(Converter, _super);\r\n    function Converter() {\r\n        var _this = _super.call(this, gl_canvas_1.gl) || this;\r\n        _this._vbo = vbo_1.default.createQuad(gl_canvas_1.gl, -1, -1, 1, 1);\r\n        _this.buildShader(\"_shaderBoxToBox\", \"converter.vert\", \"converterBoxToBox.frag\");\r\n        _this.buildShader(\"_shaderBoxToPlanet\", \"converter.vert\", \"converterBoxToPlanet.frag\");\r\n        _this.buildShader(\"_shaderBoxToSphere\", \"converter.vert\", \"converterBoxToSphere.frag\");\r\n        _this.buildShader(\"_shaderSphereToBox\", \"converter.vert\", \"converterSphereToBox.frag\");\r\n        _this.buildShader(\"_shaderSphereToPlanet\", \"converter.vert\", \"converterSphereToPlanet.frag\");\r\n        _this.buildShader(\"_shaderSphereToSphere\", \"converter.vert\", \"converterSphereToSphere.frag\");\r\n        _this.buildShader(\"_shaderPlanetToBox\", \"converter.vert\", \"converterPlanetToBox.frag\");\r\n        _this.buildShader(\"_shaderPlanetToPlanet\", \"converter.vert\", \"converterPlanetToPlanet.frag\");\r\n        _this.buildShader(\"_shaderPlanetToSphere\", \"converter.vert\", \"converterPlanetToSphere.frag\");\r\n        return _this;\r\n    }\r\n    Converter.prototype.freeGLResources = function () {\r\n        if (this._vbo) {\r\n            this._vbo.freeGLResources();\r\n            this._vbo = null;\r\n        }\r\n        this.deleteShader(\"_shaderBoxToBox\");\r\n        this.deleteShader(\"_shaderBoxToPlanet\");\r\n        this.deleteShader(\"_shaderBoxToSphere\");\r\n        this.deleteShader(\"_shaderSphereToBox\");\r\n        this.deleteShader(\"_shaderSphereToPlanet\");\r\n        this.deleteShader(\"_shaderSphereToSphere\");\r\n        this.deleteShader(\"_shaderPlanetToBox\");\r\n        this.deleteShader(\"_shaderPlanetToPlanet\");\r\n        this.deleteShader(\"_shaderPlanetToSphere\");\r\n    };\r\n    Converter.prototype.draw = function (texture) {\r\n        var shader = this.getShader(parameters_1.Parameters.inputFormat, parameters_1.Parameters.outputFormat);\r\n        if (shader) {\r\n            shader.u[\"uTexture\"].value = texture;\r\n            shader.u[\"uPaddingTop\"].value = parameters_1.Parameters.paddingTop;\r\n            shader.u[\"uPaddingBottom\"].value = parameters_1.Parameters.paddingBottom;\r\n            shader.u[\"uPaddingBack\"].value = parameters_1.Parameters.paddingBack;\r\n            shader.u[\"uRotateZ\"].value = parameters_1.Parameters.rotateZ;\r\n            shader.u[\"uFlipVertically\"].value = parameters_1.Parameters.flipVertically ? -1 : 1;\r\n            shader.use();\r\n            shader.bindUniformsAndAttributes();\r\n            gl_canvas_1.gl.drawArrays(gl_canvas_1.gl.TRIANGLE_STRIP, 0, 4);\r\n        }\r\n    };\r\n    Converter.prototype.deleteShader = function (name) {\r\n        if (this[name]) {\r\n            this[name].freeGLResources();\r\n            this[name] = null;\r\n        }\r\n    };\r\n    Converter.prototype.buildShader = function (name, vertex, fragment) {\r\n        var _this = this;\r\n        ShaderManager.buildShader({\r\n            fragmentFilename: fragment,\r\n            vertexFilename: vertex,\r\n        }, function (shader) {\r\n            if (shader !== null) {\r\n                _this[name] = shader;\r\n                _this[name].a[\"aCorner\"].VBO = _this._vbo;\r\n            }\r\n        });\r\n    };\r\n    Converter.prototype.getShader = function (inputFormat, outputFormat) {\r\n        if (inputFormat === format_utils_1.Format.Skybox) {\r\n            if (outputFormat === format_utils_1.Format.Skybox) {\r\n                return this._shaderBoxToBox;\r\n            }\r\n            else if (outputFormat === format_utils_1.Format.Skysphere) {\r\n                return this._shaderBoxToSphere;\r\n            }\r\n            else {\r\n                return this._shaderBoxToPlanet;\r\n            }\r\n        }\r\n        else if (inputFormat === format_utils_1.Format.Skysphere) {\r\n            if (outputFormat === format_utils_1.Format.Skybox) {\r\n                return this._shaderSphereToBox;\r\n            }\r\n            else if (outputFormat === format_utils_1.Format.Skysphere) {\r\n                return this._shaderSphereToSphere;\r\n            }\r\n            else {\r\n                return this._shaderSphereToPlanet;\r\n            }\r\n        }\r\n        else if (inputFormat === format_utils_1.Format.Tinyplanet) {\r\n            if (outputFormat === format_utils_1.Format.Skybox) {\r\n                return this._shaderPlanetToBox;\r\n            }\r\n            else if (outputFormat === format_utils_1.Format.Skysphere) {\r\n                return this._shaderPlanetToSphere;\r\n            }\r\n            else {\r\n                return this._shaderPlanetToPlanet;\r\n            }\r\n        }\r\n    };\r\n    return Converter;\r\n}(gl_resource_1.default));\r\nexports.default = Converter;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\r\nfunction notImplemented(gl, location, value) {\r\n    alert(\"NOT IMPLEMENTED YET\");\r\n}\r\nfunction bindUniformFloat(gl, location, value) {\r\n    if (Array.isArray(value)) {\r\n        gl.uniform1fv(location, value);\r\n    }\r\n    else {\r\n        gl.uniform1f(location, value);\r\n    }\r\n}\r\nfunction bindUniformFloat2v(gl, location, value) {\r\n    gl.uniform2fv(location, value);\r\n}\r\nfunction bindUniformFloat3v(gl, location, value) {\r\n    gl.uniform3fv(location, value);\r\n}\r\nfunction bindUniformFloat4v(gl, location, value) {\r\n    gl.uniform4fv(location, value);\r\n}\r\nfunction bindUniformInt(gl, location, value) {\r\n    if (Array.isArray(value)) {\r\n        gl.uniform1iv(location, value);\r\n    }\r\n    else {\r\n        gl.uniform1iv(location, value);\r\n    }\r\n}\r\nfunction bindUniformInt2v(gl, location, value) {\r\n    gl.uniform2iv(location, value);\r\n}\r\nfunction bindUniformInt3v(gl, location, value) {\r\n    gl.uniform3iv(location, value);\r\n}\r\nfunction bindUniformInt4v(gl, location, value) {\r\n    gl.uniform4iv(location, value);\r\n}\r\nfunction bindUniformBool(gl, location, value) {\r\n    gl.uniform1i(location, +value);\r\n}\r\nfunction bindUniformBool2v(gl, location, value) {\r\n    gl.uniform2iv(location, value);\r\n}\r\nfunction bindUniformBool3v(gl, location, value) {\r\n    gl.uniform3iv(location, value);\r\n}\r\nfunction bindUniformBool4v(gl, location, value) {\r\n    gl.uniform4iv(location, value);\r\n}\r\nfunction bindUniformFloatMat2(gl, location, value) {\r\n    gl.uniformMatrix2fv(location, false, value);\r\n}\r\nfunction bindUniformFloatMat3(gl, location, value) {\r\n    gl.uniformMatrix3fv(location, false, value);\r\n}\r\nfunction bindUniformFloatMat4(gl, location, value) {\r\n    gl.uniformMatrix4fv(location, false, value);\r\n}\r\nfunction bindSampler2D(gl, location, unitNb, value) {\r\n    gl.uniform1i(location, unitNb);\r\n    gl.activeTexture(gl[\"TEXTURE\" + unitNb]);\r\n    gl.bindTexture(gl.TEXTURE_2D, value);\r\n}\r\nfunction bindSamplerCube(gl, location, unitNb, value) {\r\n    gl.uniform1i(location, unitNb);\r\n    gl.activeTexture(gl[\"TEXTURE\" + unitNb]);\r\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, value);\r\n}\r\nvar types = {\r\n    0x8B50: { str: \"FLOAT_VEC2\", binder: bindUniformFloat2v },\r\n    0x8B51: { str: \"FLOAT_VEC3\", binder: bindUniformFloat3v },\r\n    0x8B52: { str: \"FLOAT_VEC4\", binder: bindUniformFloat4v },\r\n    0x8B53: { str: \"INT_VEC2\", binder: bindUniformInt2v },\r\n    0x8B54: { str: \"INT_VEC3\", binder: bindUniformInt3v },\r\n    0x8B55: { str: \"INT_VEC4\", binder: bindUniformInt4v },\r\n    0x8B56: { str: \"BOOL\", binder: bindUniformBool },\r\n    0x8B57: { str: \"BOOL_VEC2\", binder: bindUniformBool2v },\r\n    0x8B58: { str: \"BOOL_VEC3\", binder: bindUniformBool3v },\r\n    0x8B59: { str: \"BOOL_VEC4\", binder: bindUniformBool4v },\r\n    0x8B5A: { str: \"FLOAT_MAT2\", binder: bindUniformFloatMat2 },\r\n    0x8B5B: { str: \"FLOAT_MAT3\", binder: bindUniformFloatMat3 },\r\n    0x8B5C: { str: \"FLOAT_MAT4\", binder: bindUniformFloatMat4 },\r\n    0x8B5E: { str: \"SAMPLER_2D\", binder: bindSampler2D },\r\n    0x8B60: { str: \"SAMPLER_CUBE\", binder: bindSamplerCube },\r\n    0x1400: { str: \"BYTE\", binder: notImplemented },\r\n    0x1401: { str: \"UNSIGNED_BYTE\", binder: notImplemented },\r\n    0x1402: { str: \"SHORT\", binder: notImplemented },\r\n    0x1403: { str: \"UNSIGNED_SHORT\", binder: notImplemented },\r\n    0x1404: { str: \"INT\", binder: bindUniformInt },\r\n    0x1405: { str: \"UNSIGNED_INT\", binder: notImplemented },\r\n    0x1406: { str: \"FLOAT\", binder: bindUniformFloat },\r\n};\r\nvar ShaderProgram = (function (_super) {\r\n    __extends(ShaderProgram, _super);\r\n    function ShaderProgram(gl, vertexSource, fragmentSource) {\r\n        var _this = this;\r\n        function createShader(type, source) {\r\n            var shader = gl.createShader(type);\r\n            gl.shaderSource(shader, source);\r\n            gl.compileShader(shader);\r\n            var compileSuccess = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n            if (!compileSuccess) {\r\n                console.error(gl.getShaderInfoLog(shader));\r\n                gl.deleteShader(shader);\r\n                return null;\r\n            }\r\n            return shader;\r\n        }\r\n        _this = _super.call(this, gl) || this;\r\n        _this.id = null;\r\n        _this.uCount = 0;\r\n        _this.aCount = 0;\r\n        var vertexShader = createShader(gl.VERTEX_SHADER, vertexSource);\r\n        var fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentSource);\r\n        var id = gl.createProgram();\r\n        gl.attachShader(id, vertexShader);\r\n        gl.attachShader(id, fragmentShader);\r\n        gl.linkProgram(id);\r\n        var linkSuccess = gl.getProgramParameter(id, gl.LINK_STATUS);\r\n        if (!linkSuccess) {\r\n            console.error(gl.getProgramInfoLog(id));\r\n            gl.deleteProgram(id);\r\n        }\r\n        else {\r\n            _this.id = id;\r\n            _this.introspection();\r\n        }\r\n        return _this;\r\n    }\r\n    ShaderProgram.prototype.freeGLResources = function () {\r\n        _super.prototype.gl.call(this).deleteProgram(this.id);\r\n        this.id = null;\r\n    };\r\n    ShaderProgram.prototype.use = function () {\r\n        _super.prototype.gl.call(this).useProgram(this.id);\r\n    };\r\n    ShaderProgram.prototype.bindUniforms = function () {\r\n        var _this = this;\r\n        var gl = _super.prototype.gl.call(this);\r\n        var currTextureUnitNb = 0;\r\n        Object.keys(this.u).forEach(function (uName) {\r\n            var uniform = _this.u[uName];\r\n            if (uniform.value !== null) {\r\n                if (uniform.type === 0x8B5E || uniform.type === 0x8B60) {\r\n                    var unitNb = currTextureUnitNb;\r\n                    types[uniform.type].binder(gl, uniform.loc, unitNb, uniform.value);\r\n                    currTextureUnitNb++;\r\n                }\r\n                else {\r\n                    types[uniform.type].binder(gl, uniform.loc, uniform.value);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    ShaderProgram.prototype.bindAttributes = function () {\r\n        var _this = this;\r\n        Object.keys(this.a).forEach(function (aName) {\r\n            var attribute = _this.a[aName];\r\n            if (attribute.VBO !== null) {\r\n                attribute.VBO.bind(attribute.loc);\r\n            }\r\n        });\r\n    };\r\n    ShaderProgram.prototype.bindUniformsAndAttributes = function () {\r\n        this.bindUniforms();\r\n        this.bindAttributes();\r\n    };\r\n    ShaderProgram.prototype.introspection = function () {\r\n        var gl = _super.prototype.gl.call(this);\r\n        this.uCount = gl.getProgramParameter(this.id, gl.ACTIVE_UNIFORMS);\r\n        this.u = [];\r\n        for (var i = 0; i < this.uCount; ++i) {\r\n            var uniform = gl.getActiveUniform(this.id, i);\r\n            var name_1 = uniform.name;\r\n            this.u[name_1] = {\r\n                loc: gl.getUniformLocation(this.id, name_1),\r\n                size: uniform.size,\r\n                type: uniform.type,\r\n                value: null,\r\n            };\r\n        }\r\n        this.aCount = gl.getProgramParameter(this.id, gl.ACTIVE_ATTRIBUTES);\r\n        this.a = [];\r\n        for (var i = 0; i < this.aCount; ++i) {\r\n            var attribute = gl.getActiveAttrib(this.id, i);\r\n            var name_2 = attribute.name;\r\n            this.a[name_2] = {\r\n                VBO: null,\r\n                loc: gl.getAttribLocation(this.id, name_2),\r\n                size: attribute.size,\r\n                type: attribute.type,\r\n            };\r\n        }\r\n    };\r\n    return ShaderProgram;\r\n}(gl_resource_1.default));\r\nexports.default = ShaderProgram;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar cachedSources = {};\r\nfunction loadSource(filename, callback) {\r\n    function callAndClearCallbacks(cached) {\r\n        for (var _i = 0, _a = cached.callbacks; _i < _a.length; _i++) {\r\n            var cachedCallback = _a[_i];\r\n            cachedCallback(!cached.failed);\r\n        }\r\n        cached.callbacks = [];\r\n    }\r\n    if (typeof cachedSources[filename] === \"undefined\") {\r\n        cachedSources[filename] = {\r\n            callbacks: [callback],\r\n            failed: false,\r\n            pending: true,\r\n            text: null,\r\n        };\r\n        var cached_1 = cachedSources[filename];\r\n        var xhr_1 = new XMLHttpRequest();\r\n        xhr_1.open(\"GET\", \"./shaders/\" + filename, true);\r\n        xhr_1.onload = function () {\r\n            if (xhr_1.readyState === 4) {\r\n                cached_1.pending = false;\r\n                if (xhr_1.status === 200) {\r\n                    cached_1.text = xhr_1.responseText;\r\n                    cached_1.failed = false;\r\n                }\r\n                else {\r\n                    console.error(\"Cannot load '\" + filename + \"' shader source: \" + xhr_1.statusText);\r\n                    cached_1.failed = true;\r\n                }\r\n                callAndClearCallbacks(cached_1);\r\n            }\r\n        };\r\n        xhr_1.onerror = function () {\r\n            console.error(\"Cannot load '\" + filename + \"' shader source: \" + xhr_1.statusText);\r\n            cached_1.pending = false;\r\n            cached_1.failed = true;\r\n            callAndClearCallbacks(cached_1);\r\n        };\r\n        xhr_1.send(null);\r\n    }\r\n    else {\r\n        var cached = cachedSources[filename];\r\n        if (cached.pending === true) {\r\n            cached.callbacks.push(callback);\r\n        }\r\n        else {\r\n            callAndClearCallbacks(cached);\r\n        }\r\n    }\r\n}\r\nexports.loadSource = loadSource;\r\nfunction getSource(filename) {\r\n    return cachedSources[filename].text;\r\n}\r\nexports.getSource = getSource;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Viewport = (function () {\r\n    function Viewport(left, lower, width, height) {\r\n        this.left = left;\r\n        this.lower = lower;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    Viewport.setFullCanvas = function (gl) {\r\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\r\n    };\r\n    Viewport.prototype.set = function (gl) {\r\n        gl.viewport(this.lower, this.left, this.width, this.height);\r\n    };\r\n    return Viewport;\r\n}());\r\nexports.default = Viewport;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result[\"default\"] = mod;\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_canvas_1 = require(\"./gl-utils/gl-canvas\");\r\nvar gl_resource_1 = __importDefault(require(\"./gl-utils/gl-resource\"));\r\nvar ShaderManager = __importStar(require(\"./gl-utils/shader-manager\"));\r\nvar vbo_1 = __importDefault(require(\"./gl-utils/vbo\"));\r\nvar mat4_1 = require(\"./gl-utils/matrix/mat4\");\r\nvar vec3_1 = require(\"./gl-utils/matrix/vec3\");\r\nvar format_utils_1 = require(\"./format-utils\");\r\nvar parameters_1 = require(\"./parameters\");\r\nvar Viewer = (function (_super) {\r\n    __extends(Viewer, _super);\r\n    function Viewer() {\r\n        var _this = _super.call(this, gl_canvas_1.gl) || this;\r\n        _this._eyePos = new vec3_1.Vec3(0, 0, 0);\r\n        _this._vertical = new vec3_1.Vec3(0, 0, 1);\r\n        _this._tmpMatrix = new mat4_1.Mat4();\r\n        _this._projToWorldMatrix = new mat4_1.Mat4();\r\n        _this.resetThetaPhi();\r\n        _this._needToReloadImage = false;\r\n        _this._needToRedraw = true;\r\n        var doNeedToRedraw = function () { _this._needToRedraw = true; };\r\n        var doNeedToReloadImage = function () {\r\n            doNeedToRedraw();\r\n            _this.resetThetaPhi();\r\n            _this._needToReloadImage = true;\r\n        };\r\n        parameters_1.Parameters.onInputFormatChangeObservers.push(function (previous, newOne) {\r\n            if (previous === format_utils_1.Format.Skybox || newOne === format_utils_1.Format.Skybox) {\r\n                Canvas.showLoader(true);\r\n                doNeedToReloadImage();\r\n            }\r\n            else {\r\n                doNeedToRedraw();\r\n            }\r\n        });\r\n        parameters_1.Parameters.onChangeObservers.push(doNeedToRedraw);\r\n        Canvas.Observers.canvasResize.push(doNeedToRedraw);\r\n        Canvas.Observers.mouseDrag.push(doNeedToRedraw);\r\n        _this._vbo = vbo_1.default.createQuad(gl_canvas_1.gl, -1, -1, 1, 1);\r\n        _this.buildShader(\"_shaderSkysphere\", \"viewer.vert\", \"viewerSkysphere.frag\");\r\n        _this.buildShader(\"_shaderSkybox\", \"viewer.vert\", \"viewerSkybox.frag\");\r\n        _this.buildShader(\"_shaderTinyplanet\", \"viewer.vert\", \"viewerTinyplanet.frag\");\r\n        Canvas.Observers.mouseDrag.push(function (dX, dY) {\r\n            _this._phi += parameters_1.Parameters.fov * Canvas.getAspectRatio() * dX;\r\n            _this._theta -= parameters_1.Parameters.fov * dY;\r\n            _this._theta = Math.min(Math.PI - 0.001, Math.max(0.001, _this._theta));\r\n            doNeedToRedraw();\r\n        });\r\n        parameters_1.Parameters.onImageLoadObservers.push(function (image) {\r\n            parameters_1.Parameters.inputFormat = format_utils_1.FormatUtils.guessFormat(image);\r\n            doNeedToReloadImage();\r\n        });\r\n        return _this;\r\n    }\r\n    Viewer.prototype.freeGLResources = function () {\r\n        if (this._vbo) {\r\n            this._vbo.freeGLResources();\r\n            this._vbo = null;\r\n        }\r\n        if (this._texture) {\r\n            gl_canvas_1.gl.deleteTexture(this._texture);\r\n            this._texture = null;\r\n        }\r\n        if (this._shaderSkybox) {\r\n            this._shaderSkybox.freeGLResources();\r\n            this._shaderSkybox = null;\r\n        }\r\n        if (this._shaderSkysphere) {\r\n            this._shaderSkysphere.freeGLResources();\r\n            this._shaderSkysphere = null;\r\n        }\r\n        if (this._shaderTinyplanet) {\r\n            this._shaderTinyplanet.freeGLResources();\r\n            this._shaderTinyplanet = null;\r\n        }\r\n    };\r\n    Object.defineProperty(Viewer.prototype, \"texture\", {\r\n        get: function () {\r\n            return this._texture;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Viewer.prototype, \"needToRedraw\", {\r\n        get: function () {\r\n            return this._needToRedraw;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Viewer.prototype.update = function () {\r\n        if (this._needToReloadImage) {\r\n            if (parameters_1.Parameters.inputFormat === format_utils_1.Format.Skybox) {\r\n                this.splitAndLoadSkybox(parameters_1.Parameters.image);\r\n            }\r\n            else {\r\n                this.loadTexture(parameters_1.Parameters.image);\r\n            }\r\n            this._needToReloadImage = false;\r\n            Canvas.showLoader(false);\r\n        }\r\n    };\r\n    Viewer.prototype.draw = function () {\r\n        var shader;\r\n        if (parameters_1.Parameters.inputFormat === format_utils_1.Format.Skybox) {\r\n            shader = this._shaderSkybox;\r\n        }\r\n        else if (parameters_1.Parameters.inputFormat === format_utils_1.Format.Skysphere) {\r\n            shader = this._shaderSkysphere;\r\n        }\r\n        else {\r\n            shader = this._shaderTinyplanet;\r\n        }\r\n        if (shader) {\r\n            this.recomputeMatrices();\r\n            shader.u[\"uProjToWorld\"].value = this._projToWorldMatrix.val;\r\n            shader.u[\"uTexture\"].value = this._texture;\r\n            shader.u[\"uPaddingTop\"].value = parameters_1.Parameters.paddingTop;\r\n            shader.u[\"uPaddingBottom\"].value = parameters_1.Parameters.paddingBottom;\r\n            shader.u[\"uPaddingBack\"].value = parameters_1.Parameters.paddingBack;\r\n            shader.u[\"uRotateZ\"].value = parameters_1.Parameters.rotateZ;\r\n            shader.u[\"uFlipVertically\"].value = parameters_1.Parameters.flipVertically ? -1 : 1;\r\n            shader.u[\"uShowFrame\"].value = parameters_1.Parameters.showFrame ? 1 : 0;\r\n            shader.use();\r\n            shader.bindUniformsAndAttributes();\r\n            gl_canvas_1.gl.drawArrays(gl_canvas_1.gl.TRIANGLE_STRIP, 0, 4);\r\n        }\r\n        this._needToRedraw = false;\r\n    };\r\n    Viewer.prototype.resetThetaPhi = function () {\r\n        this._theta = 0.5 * Math.PI;\r\n        this._phi = 0;\r\n        this._needToRedraw = true;\r\n    };\r\n    Viewer.prototype.loadTexture = function (image) {\r\n        gl_canvas_1.gl.deleteTexture(this._texture);\r\n        this._texture = gl_canvas_1.gl.createTexture();\r\n        gl_canvas_1.gl.bindTexture(gl_canvas_1.gl.TEXTURE_2D, this._texture);\r\n        gl_canvas_1.gl.texImage2D(gl_canvas_1.gl.TEXTURE_2D, 0, gl_canvas_1.gl.RGBA, gl_canvas_1.gl.RGBA, gl_canvas_1.gl.UNSIGNED_BYTE, image);\r\n        gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_WRAP_S, gl_canvas_1.gl.CLAMP_TO_EDGE);\r\n        gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_WRAP_T, gl_canvas_1.gl.CLAMP_TO_EDGE);\r\n        gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_MIN_FILTER, gl_canvas_1.gl.LINEAR);\r\n        gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_MAG_FILTER, gl_canvas_1.gl.LINEAR);\r\n    };\r\n    Viewer.prototype.splitAndLoadSkybox = function (image) {\r\n        function chooseUpperPowerOfTwo(n) {\r\n            return Math.pow(2, Math.ceil(Math.log(n) * Math.LOG2E));\r\n        }\r\n        var side = chooseUpperPowerOfTwo(Math.floor(Math.max(image.width / 4, image.height / 3)));\r\n        gl_canvas_1.gl.deleteTexture(this._texture);\r\n        this._texture = gl_canvas_1.gl.createTexture();\r\n        var context = document.createElement(\"canvas\").getContext(\"2d\");\r\n        context.canvas.width = side;\r\n        context.canvas.height = side;\r\n        var sidesStyles = [\r\n            { target: gl_canvas_1.gl.TEXTURE_CUBE_MAP_POSITIVE_X, position: { x: 2, y: 1 }, rotation: 0.5 * Math.PI },\r\n            { target: gl_canvas_1.gl.TEXTURE_CUBE_MAP_NEGATIVE_X, position: { x: 0, y: 1 }, rotation: -0.5 * Math.PI },\r\n            { target: gl_canvas_1.gl.TEXTURE_CUBE_MAP_POSITIVE_Y, position: { x: 1, y: 1 }, rotation: -Math.PI },\r\n            { target: gl_canvas_1.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y, position: { x: 3, y: 1 }, rotation: 0 },\r\n            { target: gl_canvas_1.gl.TEXTURE_CUBE_MAP_POSITIVE_Z, position: { x: 1, y: 0 }, rotation: Math.PI },\r\n            { target: gl_canvas_1.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z, position: { x: 1, y: 2 }, rotation: 0 },\r\n        ];\r\n        gl_canvas_1.gl.bindTexture(gl_canvas_1.gl.TEXTURE_CUBE_MAP, this._texture);\r\n        context.translate(side, 0);\r\n        context.scale(-1, 1);\r\n        var sourceWidth = image.width / 4;\r\n        var sourceHeight = image.height / 3;\r\n        for (var _i = 0, sidesStyles_1 = sidesStyles; _i < sidesStyles_1.length; _i++) {\r\n            var sideStyle = sidesStyles_1[_i];\r\n            context.translate(0.5 * side, 0.5 * side);\r\n            context.rotate(sideStyle.rotation);\r\n            context.translate(-0.5 * side, -0.5 * side);\r\n            context.drawImage(image, sideStyle.position.x * sourceWidth, sideStyle.position.y * sourceHeight, sourceWidth, sourceHeight, 0, 0, side, side);\r\n            gl_canvas_1.gl.texImage2D(sideStyle.target, 0, gl_canvas_1.gl.RGBA, gl_canvas_1.gl.RGBA, gl_canvas_1.gl.UNSIGNED_BYTE, context.canvas);\r\n            context.translate(0.5 * side, 0.5 * side);\r\n            context.rotate(-sideStyle.rotation);\r\n            context.translate(-0.5 * side, -0.5 * side);\r\n        }\r\n        gl_canvas_1.gl.generateMipmap(gl_canvas_1.gl.TEXTURE_CUBE_MAP);\r\n        gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_CUBE_MAP, gl_canvas_1.gl.TEXTURE_MIN_FILTER, gl_canvas_1.gl.LINEAR_MIPMAP_LINEAR);\r\n        gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_CUBE_MAP, gl_canvas_1.gl.TEXTURE_MAG_FILTER, gl_canvas_1.gl.LINEAR);\r\n    };\r\n    Viewer.prototype.buildShader = function (name, vertex, fragment) {\r\n        var _this = this;\r\n        ShaderManager.buildShader({\r\n            fragmentFilename: fragment,\r\n            vertexFilename: vertex,\r\n        }, function (shader) {\r\n            if (shader !== null) {\r\n                _this[name] = shader;\r\n                _this[name].a[\"aCorner\"].VBO = _this._vbo;\r\n                _this._needToRedraw = true;\r\n            }\r\n        });\r\n    };\r\n    Viewer.prototype.recomputeMatrices = function () {\r\n        var lookAt = new vec3_1.Vec3(Math.sin(this._theta) * Math.cos(this._phi), Math.sin(this._theta) * Math.sin(this._phi), Math.cos(this._theta));\r\n        this._projToWorldMatrix.lookAt(this._eyePos, lookAt, this._vertical);\r\n        this._projToWorldMatrix.invert();\r\n        var aspectRatio = gl_canvas_1.gl.canvas.clientWidth / gl_canvas_1.gl.canvas.clientHeight;\r\n        this._tmpMatrix.perspectiveInverse(parameters_1.Parameters.fov, aspectRatio, 0.1, Infinity);\r\n        this._projToWorldMatrix.multiplyRight(this._tmpMatrix);\r\n    };\r\n    return Viewer;\r\n}(gl_resource_1.default));\r\nexports.default = Viewer;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar vec3_1 = require(\"./vec3\");\r\nvar Mat4 = (function () {\r\n    function Mat4() {\r\n        this._val = new Float32Array(16);\r\n        this.identity();\r\n    }\r\n    Object.defineProperty(Mat4, \"tmpMatrix\", {\r\n        get: function () {\r\n            if (Mat4._tmpMatrix === null) {\r\n                Mat4._tmpMatrix = new Mat4();\r\n            }\r\n            return Mat4._tmpMatrix;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Mat4.prototype, \"val\", {\r\n        get: function () {\r\n            return this._val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Mat4.prototype.identity = function () {\r\n        for (var i = 0; i < 16; ++i) {\r\n            this._val[i] = 0;\r\n        }\r\n        this._val[0] = 1;\r\n        this._val[5] = 1;\r\n        this._val[10] = 1;\r\n        this._val[15] = 1;\r\n    };\r\n    Mat4.prototype.lookAt = function (eye, center, up) {\r\n        if (eye.equals(center)) {\r\n            this.identity();\r\n            return;\r\n        }\r\n        var z = vec3_1.Vec3.substract(eye, center);\r\n        z.normalize();\r\n        var x = vec3_1.Vec3.crossProduct(up, z);\r\n        x.normalize();\r\n        var y = vec3_1.Vec3.crossProduct(z, x);\r\n        y.normalize();\r\n        this._val[0] = x.x;\r\n        this._val[1] = y.x;\r\n        this._val[2] = z.x;\r\n        this._val[3] = 0;\r\n        this._val[4] = x.y;\r\n        this._val[5] = y.y;\r\n        this._val[6] = z.y;\r\n        this._val[7] = 0;\r\n        this._val[8] = x.z;\r\n        this._val[9] = y.z;\r\n        this._val[10] = z.z;\r\n        this._val[11] = 0;\r\n        this._val[12] = -vec3_1.Vec3.dotProduct(x, eye);\r\n        this._val[13] = -vec3_1.Vec3.dotProduct(y, eye);\r\n        this._val[14] = -vec3_1.Vec3.dotProduct(z, eye);\r\n        this._val[15] = 1;\r\n    };\r\n    Mat4.prototype.multiplyRight = function (m2) {\r\n        var tmp = Mat4.tmpMatrix._val;\r\n        var myself = this._val;\r\n        var other = m2._val;\r\n        for (var iCol = 0; iCol < 4; ++iCol) {\r\n            for (var iRow = 0; iRow < 4; ++iRow) {\r\n                tmp[4 * iCol + iRow] = 0;\r\n                for (var i = 0; i < 4; ++i) {\r\n                    tmp[4 * iCol + iRow] += myself[4 * i + iRow] * other[4 * iCol + i];\r\n                }\r\n            }\r\n        }\r\n        this.swapWithTmpMatrix();\r\n    };\r\n    Mat4.prototype.invert = function () {\r\n        var m = this._val;\r\n        var m00 = m[0], m01 = m[1], m02 = m[2], m03 = m[3];\r\n        var m10 = m[4], m11 = m[5], m12 = m[6], m13 = m[7];\r\n        var m20 = m[8], m21 = m[9], m22 = m[10], m23 = m[11];\r\n        var m30 = m[12], m31 = m[13], m32 = m[14], m33 = m[15];\r\n        var b00 = m00 * m11 - m01 * m10;\r\n        var b01 = m00 * m12 - m02 * m10;\r\n        var b02 = m00 * m13 - m03 * m10;\r\n        var b03 = m01 * m12 - m02 * m11;\r\n        var b04 = m01 * m13 - m03 * m11;\r\n        var b05 = m02 * m13 - m03 * m12;\r\n        var b06 = m20 * m31 - m21 * m30;\r\n        var b07 = m20 * m32 - m22 * m30;\r\n        var b08 = m20 * m33 - m23 * m30;\r\n        var b09 = m21 * m32 - m22 * m31;\r\n        var b10 = m21 * m33 - m23 * m31;\r\n        var b11 = m22 * m33 - m23 * m32;\r\n        var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n        if (!det) {\r\n            return false;\r\n        }\r\n        det = 1.0 / det;\r\n        var tmpVals = Mat4.tmpMatrix._val;\r\n        tmpVals[0] = (m11 * b11 - m12 * b10 + m13 * b09) * det;\r\n        tmpVals[1] = (m02 * b10 - m01 * b11 - m03 * b09) * det;\r\n        tmpVals[2] = (m31 * b05 - m32 * b04 + m33 * b03) * det;\r\n        tmpVals[3] = (m22 * b04 - m21 * b05 - m23 * b03) * det;\r\n        tmpVals[4] = (m12 * b08 - m10 * b11 - m13 * b07) * det;\r\n        tmpVals[5] = (m00 * b11 - m02 * b08 + m03 * b07) * det;\r\n        tmpVals[6] = (m32 * b02 - m30 * b05 - m33 * b01) * det;\r\n        tmpVals[7] = (m20 * b05 - m22 * b02 + m23 * b01) * det;\r\n        tmpVals[8] = (m10 * b10 - m11 * b08 + m13 * b06) * det;\r\n        tmpVals[9] = (m01 * b08 - m00 * b10 - m03 * b06) * det;\r\n        tmpVals[10] = (m30 * b04 - m31 * b02 + m33 * b00) * det;\r\n        tmpVals[11] = (m21 * b02 - m20 * b04 - m23 * b00) * det;\r\n        tmpVals[12] = (m11 * b07 - m10 * b09 - m12 * b06) * det;\r\n        tmpVals[13] = (m00 * b09 - m01 * b07 + m02 * b06) * det;\r\n        tmpVals[14] = (m31 * b01 - m30 * b03 - m32 * b00) * det;\r\n        tmpVals[15] = (m20 * b03 - m21 * b01 + m22 * b00) * det;\r\n        this.swapWithTmpMatrix();\r\n        return true;\r\n    };\r\n    Mat4.prototype.perspective = function (fovy, aspectRatio, nearPlane, farPlane) {\r\n        var f = 1 / Math.tan(fovy / 2);\r\n        this._val[0] = f / aspectRatio;\r\n        this._val[1] = 0;\r\n        this._val[2] = 0;\r\n        this._val[3] = 0;\r\n        this._val[4] = 0;\r\n        this._val[5] = f;\r\n        this._val[6] = 0;\r\n        this._val[7] = 0;\r\n        this._val[8] = 0;\r\n        this._val[9] = 0;\r\n        this._val[11] = -1;\r\n        this._val[12] = 0;\r\n        this._val[13] = 0;\r\n        this._val[15] = 0;\r\n        if (farPlane === Infinity) {\r\n            this._val[10] = -1;\r\n            this._val[14] = -2 * nearPlane;\r\n        }\r\n        else {\r\n            var tmp = 1 / (nearPlane - farPlane);\r\n            this._val[10] = (farPlane + nearPlane) * tmp;\r\n            this._val[14] = (2 * farPlane * nearPlane) * tmp;\r\n        }\r\n    };\r\n    Mat4.prototype.perspectiveInverse = function (fovy, aspectRatio, nearPlane, farPlane) {\r\n        var f = Math.tan(fovy / 2);\r\n        this._val[0] = aspectRatio * f;\r\n        this._val[1] = 0;\r\n        this._val[2] = 0;\r\n        this._val[3] = 0;\r\n        this._val[4] = 0;\r\n        this._val[5] = f;\r\n        this._val[6] = 0;\r\n        this._val[7] = 0;\r\n        this._val[8] = 0;\r\n        this._val[9] = 0;\r\n        this._val[10] = 0;\r\n        this._val[12] = 0;\r\n        this._val[13] = 0;\r\n        this._val[14] = -1;\r\n        if (farPlane === Infinity) {\r\n            this._val[11] = -0.5;\r\n            this._val[15] = 0.5 / nearPlane;\r\n        }\r\n        else {\r\n            var tmp = 0.5 / (nearPlane * farPlane);\r\n            this._val[11] = (nearPlane - farPlane) * tmp;\r\n            this._val[15] = (nearPlane + farPlane) * tmp;\r\n        }\r\n    };\r\n    Mat4.prototype.swapWithTmpMatrix = function () {\r\n        var tmp = Mat4.tmpMatrix._val;\r\n        Mat4.tmpMatrix._val = this._val;\r\n        this._val = tmp;\r\n    };\r\n    Mat4._tmpMatrix = null;\r\n    return Mat4;\r\n}());\r\nexports.Mat4 = Mat4;\r\n"],"sourceRoot":""}